{"ast":null,"code":"/**\n * @license Copyright (c) 2003-2022, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md.\n */\nexport function getTrackChangesAdapter(appData) {\n  return class TrackChangesAdapter {\n    constructor(editor) {\n      this.editor = editor;\n    }\n\n    init() {\n      const usersPlugin = this.editor.plugins.get('Users');\n      const trackChangesPlugin = this.editor.plugins.get('TrackChanges');\n      const commentsRepositoryPlugin = this.editor.plugins.get('CommentsRepository'); // Load the users data.\n\n      for (const user of appData.users) {\n        usersPlugin.addUser(user);\n      } // Set the current user.\n\n\n      usersPlugin.defineMe(appData.userId); // Set the adapter to the `TrackChanges#adapter` property.\n\n      trackChangesPlugin.adapter = {\n        getSuggestion: suggestionId => {\n          // This function should query the database for data for a suggestion with a `suggestionId`.\n          console.log('Get suggestion', suggestionId);\n          return new Promise(resolve => {\n            resolve(appData.suggestions.find(suggestion => suggestionId === suggestion.id));\n          });\n        },\n        addSuggestion: suggestionData => {\n          // This function should save `suggestionData` in the database.\n          console.log('Suggestion added', suggestionData);\n          return Promise.resolve({\n            createdAt: new Date() // Should be set server-side.\n\n          });\n        },\n        updateSuggestion: (id, suggestionData) => {\n          // This function should update `suggestionData` in the database.\n          console.log('Suggestion updated', id, suggestionData);\n          return Promise.resolve();\n        }\n      }; // Track changes uses comments to allow discussing about the suggestions.\n      // The comments adapter has to be defined as well.\n\n      commentsRepositoryPlugin.adapter = {\n        getCommentThread: ({\n          threadId\n        }) => {\n          // This function should query the database for data for the comment thread with a `commentThreadId`.\n          console.log('Get comment thread', threadId);\n          return new Promise(resolve => {\n            resolve(appData.comments.find(comment => threadId === comment.threadId));\n          });\n        },\n        addComment: data => {\n          // This function should save `data` in the database.\n          console.log('Comment added', data);\n          return Promise.resolve({\n            createdAt: new Date() // Should be set server-side.\n\n          });\n        },\n        updateComment: data => {\n          // This function should save `data` in the database.\n          console.log('Comment updated', data);\n          return Promise.resolve();\n        },\n        removeComment: data => {\n          // This function should remove the comment of a given `data` from the database.\n          console.log('Comment removed', data);\n          return Promise.resolve();\n        },\n        removeCommentThread: data => {\n          // This function should remove the comment of a given `data` from the database.\n          console.log('Comment thread removed', data);\n          return Promise.resolve();\n        }\n      };\n    }\n\n  };\n}","map":null,"metadata":{},"sourceType":"module"}